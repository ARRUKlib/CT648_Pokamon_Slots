{"ast":null,"code":"import React,{useState,useEffect}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import jwt_decode from'jwt-decode';import Home from'./components/Home';import Login from'./components/Login';import Register from'./components/Register';import Game from'./components/Game';import Admin from'./components/Admin';import About from'./components/About';import Navbar from'./components/Navbar';import LoginAdmin from'./components/LoginAdmin';import RegisterAdmin from'./components/RegisterAdmin';import User from'./components/User';import Doc from'./components/Doc';import Footer from'./components/Footer';import GameSet from'./components/GameSet';import Rules from'./components/Rules';// โครงสร้างของ Token ที่จะถอดรหัส\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[token,setToken]=useState(localStorage.getItem('token'));const[role,setRole]=useState(null);useEffect(()=>{if(token){try{const decoded=jwt_decode(token);// ตรวจสอบบทบาทและกำหนดค่าใน State\nif(decoded.role)setRole(decoded.role);else setRole(null);// ตรวจสอบ Token หมดอายุ\nif(decoded.exp&&decoded.exp*1000<Date.now()){handleLogout();}}catch(error){console.error('Error decoding token:',error);handleLogout();// ถ้ามีข้อผิดพลาดในการถอดรหัส Token\n}}else{setRole(null);}},[token]);// ฟังก์ชันสำหรับเข้าสู่ระบบ\nconst handleLogin=newToken=>{setToken(newToken);// อัปเดต Token\nlocalStorage.setItem('token',newToken);// บันทึก Token ลงใน localStorage\n};// ฟังก์ชันสำหรับออกจากระบบ\nconst handleLogout=()=>{setToken(null);// ลบ Token\nsetRole(null);// ลบบทบาท\nlocalStorage.removeItem('token');// ลบ Token ออกจาก localStorage\n};return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsx(Navbar,{user:token,role:role,onLogout:handleLogout}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:token?/*#__PURE__*/_jsx(Navigate,{to:\"/home\"}):/*#__PURE__*/_jsx(Login,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:token?/*#__PURE__*/_jsx(Home,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/game\",element:token?/*#__PURE__*/_jsx(Game,{token:token,onLogout:handleLogout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/about\",element:/*#__PURE__*/_jsx(About,{})}),/*#__PURE__*/_jsx(Route,{path:\"/doc\",element:/*#__PURE__*/_jsx(Doc,{})}),/*#__PURE__*/_jsx(Route,{path:\"/rules\",element:/*#__PURE__*/_jsx(Rules,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:token&&role==='admin'?/*#__PURE__*/_jsx(Admin,{}):token?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\"})// กรณีมี token แต่ไม่ได้เป็น admin\n:/*#__PURE__*/_jsx(Navigate,{to:\"/loginAdmin\"})// กรณีไม่มี token\n}),/*#__PURE__*/_jsx(Route,{path:\"/user\",element:token&&role==='admin'?/*#__PURE__*/_jsx(User,{}):token?/*#__PURE__*/_jsx(Navigate,{to:\"/user\"}):/*#__PURE__*/_jsx(Navigate,{to:\"/loginAdmin\"})}),/*#__PURE__*/_jsx(Route,{path:\"/registerAdmin\",element:/*#__PURE__*/_jsx(RegisterAdmin,{})}),/*#__PURE__*/_jsx(Route,{path:\"/loginAdmin\",element:/*#__PURE__*/_jsx(LoginAdmin,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/gameset\",element:token&&role===\"admin\"?/*#__PURE__*/_jsx(GameSet,{})// แสดงหน้า GameSet ถ้าผู้ใช้มี token และเป็น admin\n:token?/*#__PURE__*/_jsx(Navigate,{to:\"/gameset\"}):/*#__PURE__*/_jsx(Navigate,{to:\"/loginAdmin\"})// ถ้ายังไม่ได้ล็อกอิน ให้พาไปที่หน้า LoginAdmin\n})]}),/*#__PURE__*/_jsx(Footer,{})]})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","jwt_decode","Home","Login","Register","Game","Admin","About","Navbar","LoginAdmin","RegisterAdmin","User","Doc","Footer","GameSet","Rules","jsx","_jsx","jsxs","_jsxs","App","token","setToken","localStorage","getItem","role","setRole","decoded","exp","Date","now","handleLogout","error","console","handleLogin","newToken","setItem","removeItem","children","className","user","onLogout","path","element","to","onLogin"],"sources":["/app/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\nimport jwt_decode from 'jwt-decode';\nimport Home from './components/Home';\nimport Login from './components/Login';\nimport Register from './components/Register';\nimport Game from './components/Game';\nimport Admin from './components/Admin';\nimport About from './components/About';\nimport Navbar from './components/Navbar';\nimport LoginAdmin from './components/LoginAdmin';\nimport RegisterAdmin from './components/RegisterAdmin';\nimport User from './components/User';\nimport Doc from './components/Doc';\nimport Footer from './components/Footer';\nimport GameSet from './components/GameSet';\nimport Rules from './components/Rules';\n\n// โครงสร้างของ Token ที่จะถอดรหัส\ninterface DecodedToken {\n  role?: string; // บทบาท เช่น 'user' หรือ 'admin'\n  exp?: number;  // เวลาหมดอายุของ Token (timestamp)\n}\n\nconst App: React.FC = () => {\n  const [token, setToken] = useState<string | null>(localStorage.getItem('token'));\n  const [role, setRole] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (token) {\n      try {\n        const decoded: DecodedToken = jwt_decode(token);\n        // ตรวจสอบบทบาทและกำหนดค่าใน State\n        if (decoded.role) setRole(decoded.role);\n        else setRole(null);\n\n        // ตรวจสอบ Token หมดอายุ\n        if (decoded.exp && decoded.exp * 1000 < Date.now()) {\n          handleLogout();\n        }\n      } catch (error) {\n        console.error('Error decoding token:', error);\n        handleLogout(); // ถ้ามีข้อผิดพลาดในการถอดรหัส Token\n      }\n    } else {\n      setRole(null);\n    }\n  }, [token]);\n\n  // ฟังก์ชันสำหรับเข้าสู่ระบบ\n  const handleLogin = (newToken: string) => {\n    setToken(newToken); // อัปเดต Token\n    localStorage.setItem('token', newToken); // บันทึก Token ลงใน localStorage\n  };\n\n  // ฟังก์ชันสำหรับออกจากระบบ\n  const handleLogout = () => {\n    setToken(null); // ลบ Token\n    setRole(null); // ลบบทบาท\n    localStorage.removeItem('token'); // ลบ Token ออกจาก localStorage\n  };\n\n  return (\n    <Router>\n      <div className=\"app-container\">\n        {/* Navbar */}\n        <Navbar user={token} role={role} onLogout={handleLogout} />\n        \n        {/* Routes */}\n        <Routes>\n          {/* สำหรับ User */}\n          <Route\n            path=\"/\"\n            element={token ? <Navigate to=\"/home\" /> : <Login onLogin={handleLogin} />}\n          />\n          <Route\n            path=\"/home\"\n            element={token ? <Home /> : <Navigate to=\"/\" />}\n          />\n          <Route path=\"/register\" element={<Register />} />\n          <Route\n            path=\"/game\"\n            element={token ? <Game token={token} onLogout={handleLogout} /> : <Navigate to=\"/\" />}\n          />\n          <Route path=\"/about\" element={<About />} />\n          <Route path=\"/doc\" element={<Doc />} />\n          <Route path=\"/rules\" element={<Rules />} />\n\n          {/* สำหรับ Admin */}\n          <Route\n            path=\"/admin\"\n            element={\n              token && role === 'admin' ? (\n                <Admin />\n              ) : token ? (\n                <Navigate to=\"/admin\" /> // กรณีมี token แต่ไม่ได้เป็น admin\n              ) : (\n                <Navigate to=\"/loginAdmin\" /> // กรณีไม่มี token\n              )\n            }\n          />\n          <Route\n            path=\"/user\"\n            element={\n              token && role === 'admin' ? (\n                <User />\n              ) : token ? (\n                <Navigate to=\"/user\" />\n              ) : (\n                <Navigate to=\"/loginAdmin\" />\n              )\n            }\n            />\n\n          <Route path=\"/registerAdmin\" element={<RegisterAdmin />} />\n\n          <Route\n            path=\"/loginAdmin\"\n            element={<LoginAdmin onLogin={handleLogin} />}\n          />\n\n          <Route\n            path=\"/gameset\"\n            element={\n              token && role === \"admin\" ? (\n                <GameSet /> // แสดงหน้า GameSet ถ้าผู้ใช้มี token และเป็น admin\n              ) : token ? (\n                <Navigate to=\"/gameset\" /> \n              ) : (\n                <Navigate to=\"/loginAdmin\" /> // ถ้ายังไม่ได้ล็อกอิน ให้พาไปที่หน้า LoginAdmin\n              )\n            }\n          />\n          \n        </Routes>\n\n        {/* Footer */}\n        <Footer />\n      </div>\n    </Router>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}