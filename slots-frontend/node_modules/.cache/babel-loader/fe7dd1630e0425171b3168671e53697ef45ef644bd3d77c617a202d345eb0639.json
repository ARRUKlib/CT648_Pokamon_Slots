{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import jwt_decode from'jwt-decode';import{useNavigate}from'react-router-dom';import'./Auth.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginAdmin=_ref=>{let{onLogin}=_ref;const[username,setUsername]=useState('');// เก็บค่า username\nconst[password,setPassword]=useState('');// เก็บค่า password\nconst[error,setError]=useState(null);// เก็บข้อความข้อผิดพลาด\nconst navigate=useNavigate();// ใช้สำหรับนำทางไปยังหน้าอื่น\nconst handleSubmit=async event=>{event.preventDefault();// ป้องกันการรีเฟรชหน้าเว็บ\ntry{// เรียก API สำหรับล็อกอินแอดมิน\nconst response=await axios.post('http://3.24.50.90:3000/api/admin-login',{username,password});const token=response.data.token;// บันทึก token ลงใน localStorage\nlocalStorage.setItem('token',token);// แจ้งแอปว่าผู้ใช้ล็อกอินสำเร็จ\nonLogin(token);// Decode token เพื่อดึงข้อมูลเพิ่มเติม\nconst decodedToken=jwt_decode(token);console.log('Decoded Admin Token:',decodedToken);// เรียก API เพื่อบันทึกการล็อกอิน\nawait axios.post('http://3.24.50.90:3000/api/record-login',{admin_id:decodedToken.adminId||null},// ระบุ admin_id หรือ null\n{headers:{Authorization:`Bearer ${token}`}// ส่ง token ไปใน Header\n});// นำทางไปยังหน้าแอดมิน\nnavigate('/admin');}catch(error){// ตั้งค่าข้อความแสดงข้อผิดพลาด\nsetError('Admin Login failed. Please check your username and password.');}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-background\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"auth-title\",children:\"Login Admin\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter username...\",value:username,onChange:e=>setUsername(e.target.value),className:\"login-input\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Enter password...\",value:password,onChange:e=>setPassword(e.target.value),className:\"login-input\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-button\",children:\"Login\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"register-link\",children:[\"Don't have an account? \",/*#__PURE__*/_jsx(\"a\",{href:\"/registerAdmin\",children:\"Sign up\"})]})]})});};export default LoginAdmin;","map":{"version":3,"names":["React","useState","axios","jwt_decode","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginAdmin","_ref","onLogin","username","setUsername","password","setPassword","error","setError","navigate","handleSubmit","event","preventDefault","response","post","token","data","localStorage","setItem","decodedToken","console","log","admin_id","adminId","headers","Authorization","className","children","style","color","onSubmit","type","placeholder","value","onChange","e","target","required","href"],"sources":["/app/src/components/LoginAdmin.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport { useNavigate } from 'react-router-dom';\nimport './Auth.css';\n\ninterface LoginProps {\n  onLogin: (token: string) => void; // ฟังก์ชันสำหรับจัดการการเข้าสู่ระบบ\n}\n\nconst LoginAdmin: React.FC<LoginProps> = ({ onLogin }) => {\n  const [username, setUsername] = useState(''); // เก็บค่า username\n  const [password, setPassword] = useState(''); // เก็บค่า password\n  const [error, setError] = useState<string | null>(null); // เก็บข้อความข้อผิดพลาด\n  const navigate = useNavigate(); // ใช้สำหรับนำทางไปยังหน้าอื่น\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault(); // ป้องกันการรีเฟรชหน้าเว็บ\n\n    try {\n      // เรียก API สำหรับล็อกอินแอดมิน\n      const response = await axios.post('http://3.24.50.90:3000/api/admin-login', { username, password });\n      const token = response.data.token;\n\n      // บันทึก token ลงใน localStorage\n      localStorage.setItem('token', token);\n\n      // แจ้งแอปว่าผู้ใช้ล็อกอินสำเร็จ\n      onLogin(token);\n\n      // Decode token เพื่อดึงข้อมูลเพิ่มเติม\n      const decodedToken: any = jwt_decode(token);\n      console.log('Decoded Admin Token:', decodedToken);\n\n      // เรียก API เพื่อบันทึกการล็อกอิน\n      await axios.post(\n        'http://3.24.50.90:3000/api/record-login',\n        { admin_id: decodedToken.adminId || null }, // ระบุ admin_id หรือ null\n        {\n          headers: { Authorization: `Bearer ${token}` }, // ส่ง token ไปใน Header\n        }\n      );\n\n      // นำทางไปยังหน้าแอดมิน\n      navigate('/admin');\n    } catch (error) {\n      // ตั้งค่าข้อความแสดงข้อผิดพลาด\n      setError('Admin Login failed. Please check your username and password.');\n    }\n  };\n\n  return (\n    <div className=\"auth-background\">\n      <div className=\"auth-container\">\n        <h1 className=\"auth-title\">Login Admin</h1>\n        {/* แสดงข้อผิดพลาดถ้ามี */}\n        {error && <p style={{ color: 'red' }}>{error}</p>}\n        <form onSubmit={handleSubmit}>\n          <input\n            type=\"text\"\n            placeholder=\"Enter username...\"\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n            className=\"login-input\"\n            required\n          />\n          <input\n            type=\"password\"\n            placeholder=\"Enter password...\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            className=\"login-input\"\n            required\n          />\n          <button type=\"submit\" className=\"login-button\">Login</button>\n        </form>\n        {/* เพิ่มปุ่ม Sign Up */}\n        <div className=\"register-link\">\n          Don't have an account? <a href=\"/registerAdmin\">Sign up</a>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginAdmin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}